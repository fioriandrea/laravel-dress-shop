<!doctype html>
<html>

<head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">

    <!--include bootstrap icons-->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.3.0/font/bootstrap-icons.css">

    <link rel="stylesheet" href="./style.css">

    <title>Dress Shop</title>
</head>

<body>
    <div class="container">
        <!--we need a form that allows to insert a new payment method. The form should ask for-->
        <!--an owner, credit card number, expiration date-->
        <form class="user-form">
            <div class="form-group">
                <label for="owner-first-name">Owner's First Name</label>
                <input required type="text" class="form-control" id="owner-first-name" name="owner-first-name">
            </div>
            <div class="form-group">
                <label for="owner-first-name">Owner's Second Name</label>
                <input required type="text" class="form-control" id="owner-first-name" name="owner-first-name">
            </div>
            <div class="form-group">
                <label for="ccn">Credit Card Number</label>
                <input required class="form-control" id="ccn" type="tel" inputmode="numeric">
            </div>
            <div class="form-group">
                <label required for="expiration_date">Expiration Date</label>
                <input required type="month" class="form-control" id="expiration-date" name="expiration_date">
            </div>
            <button type="submit" class="w-100 btn btn-outline-primary">Submit</button>
        </form>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p"
        crossorigin="anonymous"></script>
    <script>
        /*
        * Precondition: input an input element and the form containing it
        * Postcondition: credit card number formatting is applied to the input element with id inputid
        */
        const mkcreditCardFormatter = (input, form, len = 16, placeholderSym = 'X', delim = ' ') => {
            /* 
            * Precondition: value is a string
            * Postcondition: returns the original string with delim every 4 digits
            */
            const formatCardNumber = (value, delim = ' ') => {
                const res = [];
                for (let i = 0; i < value.length; i++) {
                    if (i % 4 === 0 && i !== 0) {
                        res.push(delim);
                    }
                    res.push(value[i]);
                }
                return res.join('');
            };
            const getreal = (value) => value.replaceAll(delim, '');

            let real = getreal(input.value);

            input.placeholder = formatCardNumber(new Array(len).fill(placeholderSym).join(''));
            input.pattern = `.{${len},}`;

            input.addEventListener('input', (e) => {
                real = getreal(e.target.value);
                real = real.replaceAll(/[^\d]+/g, '');
                real = real.slice(0, len);
                input.value = formatCardNumber(real, delim);

            });
            form.addEventListener('submit', (e) => {
                input.value = real;
            });
        };

        mkcreditCardFormatter(document.querySelector('#ccn'), document.querySelector('form'));
    </script>
</body>

</html>